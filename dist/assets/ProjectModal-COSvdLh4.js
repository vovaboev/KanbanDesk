import{u as R,a as m,y as x,o as B,z as A,c as g,f as k,p as v,b as c,t as b,g as $,v as T,n as E,F as I,B as L,s as M,e as N,w as U}from"./index-pzVUFiZV.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";const D={get(t,e){try{const s=e?`${t}_${e}`:t,l=localStorage.getItem(s),a=l?JSON.parse(l):null;return console.log(`ðŸ“– Ð§Ñ‚ÐµÐ½Ð¸Ðµ Ð¸Ð· storage: ${s}`,(a==null?void 0:a.length)||a),a}catch(s){return console.error("âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ñ‡Ñ‚ÐµÐ½Ð¸Ñ Ð¸Ð· localStorage:",s),null}},set(t,e,s){try{const l=s?`${t}_${s}`:t,a=JSON.stringify(e);return localStorage.setItem(l,a),console.log(`ðŸ’¾ Ð—Ð°Ð¿Ð¸ÑÑŒ Ð² storage: ${l}`,(e==null?void 0:e.length)||"object"),!0}catch(l){return console.error("âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð¿Ð¸ÑÐ¸ Ð² localStorage:",l),!1}},remove(t,e){try{const s=e?`${t}_${e}`:t;localStorage.removeItem(s),console.log(`ðŸ—‘ï¸ Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð¸Ð· storage: ${s}`)}catch(s){console.error("âŒ ÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ð¸Ð· localStorage:",s)}},clearUserData(t){if(!t)return;Object.keys(localStorage).forEach(s=>{s.endsWith(`_${t}`)&&localStorage.removeItem(s)})},getUserKeys(t){return t?Object.keys(localStorage).filter(s=>s.endsWith(`_${t}`)):[]}},K=(t="")=>t+Date.now().toString(36)+Math.random().toString(36).substr(2),le=(t,e={})=>{if(!t)return"";const s=new Date(t),l={day:"2-digit",month:"2-digit",year:"numeric"};return s.toLocaleDateString("ru-RU",{...l,...e})},ce=t=>{if(!t)return null;const e=new Date;e.setHours(0,0,0,0);const s=new Date(t);s.setHours(0,0,0,0);const l=Math.ceil((s-e)/(1e3*60*60*24));return l<0?"overdue":l===0?"today":l<=3?"soon":"normal"},ie=t=>{if(!t)return"";const e=new Date(t),s=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${s}-${l}-${a}`},G=()=>{const t=["#667eea","#764ba2","#f093fb","#4facfe","#43e97b","#38f9d7","#fa709a","#fee140"];return t[Math.floor(Math.random()*t.length)]},p={BACKLOG:"backlog",IN_PROGRESS:"in_progress",DONE:"done"},ue={[p.BACKLOG]:"Backlog",[p.IN_PROGRESS]:"Ð’ Ñ€Ð°Ð±Ð¾Ñ‚Ðµ",[p.DONE]:"Ð“Ð¾Ñ‚Ð¾Ð²Ð¾"};p.BACKLOG+"",p.IN_PROGRESS+"",p.DONE+"";const V=["#667eea","#764ba2","#f093fb","#4facfe","#43e97b","#38f9d7","#fa709a","#fee140","#a8edea","#fed6e3","#ff9a9e","#fad0c4"],P="#667eea";function de(){const t=R(),e=m([]),s=m(!1),l=m(null),a=()=>{var r;return`kanban_projects_${((r=t.user)==null?void 0:r.id)||"guest"}`},u=()=>{try{s.value=!0;const o=a(),r=D.get(o);if(r)e.value=r.map(n=>({...n,createdAt:new Date(n.createdAt),updatedAt:new Date(n.updatedAt)}));else{const n={id:K("proj_"),title:"ÐœÐ¾Ð¹ Ð¿ÐµÑ€Ð²Ñ‹Ð¹ Ð¿Ñ€Ð¾ÐµÐºÑ‚",description:"Ð­Ñ‚Ð¾ Ð´ÐµÐ¼Ð¾-Ð¿Ñ€Ð¾ÐµÐºÑ‚. Ð¡Ð¾Ð·Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ ÑÐ²Ð¾Ð¸ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ñ‹ Ð¸ Ð·Ð°Ð´Ð°Ñ‡Ð¸!",color:P,createdAt:new Date,updatedAt:new Date,taskCount:3};e.value=[n],i()}}catch(o){l.value="ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð¾Ð²",console.error(o)}finally{s.value=!1}},i=()=>{const o=a();return D.set(o,e.value)},C=o=>{var n;const r={id:K("proj_"),title:o.title.trim(),description:((n=o.description)==null?void 0:n.trim())||"",color:o.color||G(),createdAt:new Date,updatedAt:new Date,taskCount:0};return e.value.unshift(r),i(),r},_=(o,r)=>{const n=e.value.findIndex(h=>h.id===o);if(n===-1)return null;const f={...e.value[n],...r,updatedAt:new Date};return e.value[n]=f,i(),f},j=o=>{var O;if(!confirm("Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¾ÐµÐºÑ‚ Ð¸ Ð²ÑÐµ ÐµÐ³Ð¾ Ð·Ð°Ð´Ð°Ñ‡Ð¸?"))return!1;const r=e.value.findIndex(w=>w.id===o);if(r===-1)return!1;e.value.splice(r,1),i();const n=`kanban_tasks_${((O=t.user)==null?void 0:O.id)||"guest"}`,h=(D.get(n)||[]).filter(w=>w.projectId!==o);return D.set(n,h),!0},y=o=>e.value.find(r=>r.id===o),S=(o,r)=>{const n=y(o);return n?(n.taskCount=r,n.updatedAt=new Date,i(),!0):!1},d=x(()=>{const o=e.value.length,r=e.value.reduce((f,h)=>f+(h.taskCount||0),0),n=e.value.filter(f=>!f.archived).length;return{totalProjects:o,totalTasks:r,activeProjects:n}});return B(()=>{u()}),{projects:e,loading:s,error:l,createProject:C,updateProject:_,deleteProject:j,getProjectById:y,updateTaskCount:S,projectsStats:d,loadProjects:u,saveProjects:i}}const J={class:"modal"},z={class:"modal-header"},q={class:"modal-body"},H={class:"form-group"},W={key:0,class:"error-message"},Y={class:"form-group"},Q={class:"form-group"},X={class:"color-picker"},Z=["onClick"],ee={key:0,class:"check-icon"},te={key:0,class:"submit-error"},oe={class:"modal-footer"},se=["disabled"],re={__name:"ProjectModal",props:{show:{type:Boolean,required:!0},editingProject:{type:Object,default:null}},emits:["close","save"],setup(t,{emit:e}){const s=t,l=e,a=m({title:"",description:"",color:P}),u=m({}),i=m(""),C=V,_=()=>{S(),l("close")},j=()=>{y()&&(l("save",{...a.value,title:a.value.title.trim()}),S())},y=()=>(u.value={},a.value.title.trim()?!0:(u.value.title="Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°",!1)),S=()=>{a.value={title:"",description:"",color:P},u.value={},i.value=""};return A(()=>s.editingProject,d=>{d&&(a.value={title:d.title,description:d.description||"",color:d.color||P})}),A(()=>s.show,d=>{d||S()}),(d,o)=>t.show?(v(),g("div",{key:0,class:"modal-overlay",onClick:U(_,["self"])},[c("div",J,[c("div",z,[c("h2",null,b(t.editingProject?"Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾ÐµÐºÑ‚":"ÐÐ¾Ð²Ñ‹Ð¹ Ð¿Ñ€Ð¾ÐµÐºÑ‚"),1),c("button",{onClick:_,class:"close-btn"},"Ã—")]),c("div",q,[c("div",H,[o[2]||(o[2]=c("label",null,"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð° *",-1)),$(c("input",{"onUpdate:modelValue":o[0]||(o[0]=r=>a.value.title=r),type:"text",required:"",placeholder:"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°",class:E(["form-input",{error:u.value.title}])},null,2),[[T,a.value.title]]),u.value.title?(v(),g("div",W,b(u.value.title),1)):k("",!0)]),c("div",Y,[o[3]||(o[3]=c("label",null,"ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ",-1)),$(c("textarea",{"onUpdate:modelValue":o[1]||(o[1]=r=>a.value.description=r),rows:"3",placeholder:"ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°...",class:"form-textarea"},null,512),[[T,a.value.description]])]),c("div",Q,[o[4]||(o[4]=c("label",null,"Ð¦Ð²ÐµÑ‚ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°",-1)),c("div",X,[(v(!0),g(I,null,L(N(C),r=>(v(),g("div",{key:r,class:E(["color-option",{selected:a.value.color===r}]),style:M({backgroundColor:r}),onClick:n=>a.value.color=r},[a.value.color===r?(v(),g("span",ee,"âœ“")):k("",!0)],14,Z))),128))])]),i.value?(v(),g("div",te,b(i.value),1)):k("",!0)]),c("div",oe,[c("button",{onClick:_,class:"btn btn-cancel"}," ÐžÑ‚Ð¼ÐµÐ½Ð° "),c("button",{onClick:j,class:"btn btn-save",disabled:!a.value.title.trim()},b(t.editingProject?"Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ":"Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ"),9,se)])])])):k("",!0)}},fe=F(re,[["__scopeId","data-v-d4aaa372"]]);export{fe as P,p as T,ue as a,ce as b,ie as c,le as f,K as g,D as s,de as u};
